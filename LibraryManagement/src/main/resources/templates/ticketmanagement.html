<!DOCTYPE html>
<html>
<head>
<title>Ticket Management</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../resources/js/ticketmanagement.js"></script>
</head>
<body>
	<div class="container">
		<h2>Tickets Management</h2>
		<div class="topnav">
			<div class="search-container">
				<form action="#">
					<input type="text" id="w-input-searchuser" placeholder="Search.." name="search">
					<button type="submit">
						<i class="fa fa-search"></i>
					</button>
				</form>
			</div>
		</div>
		<table class="table">
			<thead>
				<tr>
					<th>ID User</th>
					<th>User Name</th>
					<th>Full Name</th>
					<th>Role</th>
					<th>Limit Number</th>
					<th>Borrowed Number</th>
					<th></th>
				</tr>
			</thead>
			<tbody id="tickets-management">
			
			</tbody>
		</table>
		<div class="divNextPage">
			<nav aria-label="Page navigation" style="text-align:center">
	        	<ul class="pagination" id="pagination"></ul>
	    	</nav>
		</div>


		<!-- Modal -->
		<div class="modal fade" id="add" role="dialog">
			<div class="modal-dialog modal-lg">

				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Update Limit Number</h4>
					</div>
					<div class="modal-body">
						<div class="wrapper">
							<table class="table">
								<thead>
									<tr>
										<th>ID User</th>
										<th>User Name</th>
										<th>Full Name</th>
										<th>Role</th>
										<th>Limit Number</th>
										<th>Borrowed Number</th>
										<th></th>

									</tr>
								</thead>
								<tbody>
									<tr>
										<td>
											<div class="form-group">
												<input type="text" class="form-control" id="ticket-id" value="1">
											</div>
										</td>
										<td>
											<div class="form-group">
												<input type="text" class="form-control" id="ticket-mail" value="aaaa1">
											</div>
										</td>
										<td>
											<div class="form-group">
												<input type="text" class="form-control" id="ticket-name" value="Donal Trump">
											</div>
										</td>
										<td>
											<div class="form-group">
												<input type="text" class="form-control" id="ticket-role" value="1">
											</div>
										</td>
										<td>
											<div class="form-group">
												<input type="text" class="form-control" id="ticket-limit" value="8">
											</div>
										</td>
										<td>
											<div class="form-group">
												<input type="text" class="form-control" id="ticket-borrowed" value="2">
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-success" id="edit-ticket">Submit</button>
						<button type="button" class="btn btn-success" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Modal View-->
		<div class="modal fade" id="modalview" role="dialog">
			<div class="modal-dialog modal-lg">

				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title" id="title-and-name">Borrowed Books</h4>
					</div>
					<div class="modal-body">
						<div class="wrapper">
							<table class="table">
								<thead>
									<tr>
										<th>ISBN</th>
										<th>Title</th>
										<th>Author</th>
										<th>Publish</th>
										<th>Borrow Date</th>
										<th>Total</th>
										<th></th>
									</tr>
								</thead>
								<tbody id="ticket-borrowed-book">
									
								</tbody>
							</table>

						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-success" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>



	</div>
</body>

  <script>
  $(document).ready(function() {
	$('#w-input-searchuser').autocomplete({
		autoSelectFirst: true,
		serviceUrl: '/search/user',
		paramName: "username",
		delimiter: ",",
		onSelect: function(suggestion) {
			getinforuser(suggestion.data);
        },
	   transformResult: function(response) {
		    	
		return {      	
		  //must convert json to javascript object before process
		  suggestions: $.map($.parseJSON(response), function(item) {
		      return { value: item.fullName + '( Account: ' + item.userName + ' ) ', data: item.idUser };
		   })
		            
		 };
        }
	 });
	function getinforuser(iduser) {
		$.ajax({
			type : "GET",
			dataType : 'json',
			contentType : "application/json",
			url : '/search/user/' + iduser,
			success : function(data) {
				if (data != null && data.idUser != null) {
					alert(data.idUser);
				}
				
				 //window.location.href = "home";
			},
			error : function(e) {
				console.log("ERROR : ", e);
			}
		});
	}
  });
  </script>


</html>